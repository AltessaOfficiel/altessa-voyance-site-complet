<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Altessa Voyance — Poser votre question</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css" />

  <!-- PAYPAL SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=BAA3LPdWYhDwfbYcXsmBhfCHXhRtcth_XEFw9tpnDSr42xeS7cdHDPl4kkudskfXSomt0uyjCfsdvzBBz8&components=hosted-buttons&disable-funding=venmo&currency=EUR"></script>
</head>

<body class="page-contact">

<header class="header">
  <div class="logo">
    <img src="assets/img/logo-altessa.png" alt="Logo Altessa">
    <div class="logo-text">
      <span class="logo-main">Altessa</span>
      <span class="logo-sub">Voyance</span>
    </div>
  </div>

  <nav class="nav">
    <a href="index.html">Accueil</a>
    <a href="experts.html">Experts</a>
    <a href="tarifs.html">Tarifs</a>
    <a href="contact.html" class="btn-nav active">Contact</a>
  </nav>
</header>

<main>

  <section class="hero hero-inner">
    <h1 class="hero-title hero-title-small">Poser votre question</h1>
    <p class="hero-text hero-text-centered">
      <strong>Étape 1 :</strong> Choisissez votre consultation et réglez en toute sécurité.<br>
      <strong>Étape 2 :</strong> Remplissez le formulaire pour transmettre votre question à l’expert choisi.<br>
      <strong>Réponse envoyée par e-mail entre 15 et 45 minutes.</strong>
    </p>
  </section>

  <section class="section">
    <div class="form-section">

      <h2 class="section-title">1. Choisissez votre consultation</h2>

      <div class="question-form">

        <div class="form-row">
          <label>Expert sélectionné</label>
          <input type="text" id="expert-display" readonly />
        </div>

        <div class="form-row">
          <label>Type de consultation*</label>
          <select id="consultation-type" required>
            <option value="">Choisissez…</option>
            <option value="question">À la question — 8€</option>
            <option value="sentimentale">Voyance sentimentale — 20€</option>
            <option value="professionnelle">Voyance professionnelle — 20€</option>
            <option value="financiere">Voyance financière — 20€</option>
            <option value="generale">Voyance générale — 45€</option>
            <option value="soin">Soin énergétique — 50€</option>
          </select>
        </div>

        <p class="form-note" id="payment-info">
          Après avoir choisi votre consultation, cliquez sur le bouton PayPal ci-dessous pour régler.
          Une fois le paiement effectué, vous serez redirigé sur une page de confirmation.
        </p>
      </div>

      <!-- PANELS PAYPAL -->
      <div id="paypal-panels">

        <div class="paypal-panel" data-type="question" style="display:none;">
          <div id="paypal-q"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"LGCWPQ9JHDT5U" }).render("#paypal-q");</script>
        </div>

        <div class="paypal-panel" data-type="sentimentale" style="display:none;">
          <div id="paypal-s"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"H8LA54EZY2T46" }).render("#paypal-s");</script>
        </div>

        <div class="paypal-panel" data-type="professionnelle" style="display:none;">
          <div id="paypal-p"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"A3DZS2TAYSGYS" }).render("#paypal-p");</script>
        </div>

        <div class="paypal-panel" data-type="financiere" style="display:none;">
          <div id="paypal-f"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"AJDZ94JCHR8U8" }).render("#paypal-f");</script>
        </div>

        <div class="paypal-panel" data-type="generale" style="display:none;">
          <div id="paypal-g"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"GT986X6GT42PA" }).render("#paypal-g");</script>
        </div>

        <div class="paypal-panel" data-type="soin" style="display:none;">
          <div id="paypal-e"></div>
          <script>paypal.HostedButtons({ hostedButtonId:"AY42SMUCPK3YU" }).render("#paypal-e");</script>
        </div>

      </div>

      <hr style="margin:40px 0; opacity:0.15;">

      <h2 class="section-title">2. Posez votre question</h2>

      <form class="contact-form" id="voyance-form"
       action="https://altessa.app.n8n.cloud/webhook/voyance"
       method="POST">

        <input type="hidden" name="expert" id="form-expert">
        <input type="hidden" name="type"   id="form-type">

        <div class="form-row">
          <label>Nom complet*</label>
          <input type="text" name="nom" required />
        </div>

        <div class="form-row">
          <label>Adresse e-mail*</label>
          <input type="email" name="email" required />
        </div>

        <div class="form-row">
          <label>Date de naissance*</label>
          <input type="date" name="date_naissance" required />
        </div>

        <div class="form-row sentimental-only" style="display:none;">
          <label>Prénom de la 2e personne (optionnel)</label>
          <input type="text" name="autre_personne">
        </div>

        <div class="form-row">
          <label>Votre question / situation*</label>
          <textarea name="message" rows="6" required></textarea>
        </div>

        <button type="submit" class="btn-primary btn-full" id="submit-btn">
          Envoyer ma question
        </button>

      </form>

    </div>
  </section>

</main>

<footer class="footer">
  Altessa Voyance © — Service réservé aux personnes majeures.
</footer>

<script>
(function () {

  const params = new URLSearchParams(window.location.search);
  const testMode = params.get("test") === "1"; // MODE TEST ACTIVÉ

  const expertFromUrl = params.get("expert");
  const expertStored = localStorage.getItem("altessaExpert");
  const expertName = expertFromUrl || expertStored || "Votre expert Altessa";

  document.getElementById("expert-display").value = expertName;
  document.getElementById("form-expert").value = expertName;
  localStorage.setItem("altessaExpert", expertName);

  const typeSelect = document.getElementById("consultation-type");
  const hiddenTypeInput = document.getElementById("form-type");
  const sentimentalBloc = document.querySelector(".sentimental-only");
  const paypalPanels = document.querySelectorAll(".paypal-panel");
  const submitBtn = document.getElementById("submit-btn");
  const paymentInfo = document.getElementById("payment-info");

  function updateType() {
    const val = typeSelect.value;
    hiddenTypeInput.value = val;

    paypalPanels.forEach(panel => {
      panel.style.display = (panel.dataset.type === val && !testMode) ? "block" : "none";
    });

    sentimentalBloc.style.display = (val === "sentimentale") ? "block" : "none";
  }

  typeSelect.addEventListener("change", updateType);
  updateType();

  // MODE TEST = pas de paiement requis
  if (testMode) {
    submitBtn.disabled = false;
    submitBtn.style.opacity = "1";
    paymentInfo.style.display = "none";
  } else {
    // BLOCAGE SI PAS PAYÉ
    submitBtn.disabled = true;
    submitBtn.style.opacity = "0.5";
  }

  // FORMULAIRE NON BLOQUÉ EN TEST
  document.getElementById("voyance-form").addEventListener("submit", function(e) {
    if (!testMode && submitBtn.disabled) {
      e.preventDefault();
      alert("Vous devez payer votre consultation avant d'envoyer votre question.");
    }
  });

})();
</script>

</body>
</html>



